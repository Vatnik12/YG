<!DOCTYPE html>
<html lang="ru" class="scroll-smooth">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OneScreen План/Факт — by Vatnik</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    .app-blur { filter: blur(8px); transform: scale(1.02); transition: filter .6s ease, transform .6s ease; }
    .unblur { filter: blur(0); transform: scale(1); }

    /* Splash base + creative reveal */
    #splash { position: fixed; inset: 0; z-index: 50; display: grid; place-items: center; background:#0b1020; overflow:hidden;
      transition: opacity .6s ease; clip-path: circle(150% at 50% 50%); }
    #splash.fade-out { opacity: 0; }
    #splash::after{ content:""; position:absolute; inset:0; pointer-events:none;
      background: radial-gradient(65% 65% at 50% 35%, transparent, rgba(0,0,0,.4)); }

    /* Keyframe for circular reveal */
    @keyframes splash-out { to { clip-path: circle(0% at 50% 50%); opacity: 0; } }
    #splash.out { animation: splash-out .75s cubic-bezier(.8,0,.2,1) forwards; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #splash { transition: none; }
      #splash.out { animation: none; opacity: 0; }
      .app-blur, .unblur { transition: none; }
    }
  </style>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100">

  <!-- SPLASH -->
  <div id="splash">
    <div class="relative w-full h-full">
      <img src="./assets/bg.jpg" alt="" class="absolute inset-0 w-full h-full object-cover opacity-60" loading="eager">
      <div class="absolute inset-0 bg-gradient-to-b from-indigo-900/20 via-slate-900/30 to-slate-900/70"></div>
      <div class="relative h-full w-full flex items-center justify-center">
        <div id="splashContent" class="text-center select-none">
          <div class="inline-flex items-center gap-3 px-5 py-2 rounded-2xl bg-white/10 backdrop-blur ring-1 ring-white/20">
            <span class="text-white/90 font-semibold tracking-wide">OneScreen</span>
          </div>
          <h1 class="mt-5 text-3xl md:text-5xl font-extrabold text-white drop-shadow">План/Факт <span class="text-indigo-200">by Vatnik</span></h1>
          <p class="mt-3 text-white/80">Перетащи xlsx — получи красивый коллаж задач.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- APP (демо-каркас; твой UI ниже) -->
  <div id="app" class="app-blur min-h-screen">
    <header class="p-4 bg-white dark:bg-slate-800 shadow">OneScreen UI тут</header>
    <main class="p-10 space-y-6">
      <p class="text-slate-600 dark:text-slate-300">Основной интерфейс</p>
      <div class="h-[120vh] rounded-xl border border-slate-200/70 dark:border-slate-800 bg-white/60 dark:bg-slate-800/40"></div>
    </main>
  </div>

  <script>
    // --- Robust splash controller (no external deps)
    const splash = document.getElementById('splash');
    const app = document.getElementById('app');

    const finishSplash = () => {
      if (!splash || splash.dataset.closed==='1') return;
      splash.dataset.closed = '1';
      // Unblur app immediately for responsive feel
      app?.classList.add('unblur');
      app?.classList.remove('app-blur');
      // Play out animation (circle collapse)
      splash.classList.add('out');
      const cleanup = () => { try { splash.remove(); } catch(_) {} window.removeEventListener('scroll', onScrollReveal, { passive:true }); };
      splash.addEventListener('animationend', cleanup, { once:true });
      // Fallback cleanup in case animationend doesn't fire
      setTimeout(cleanup, 1000);
    };

    // Auto-hide after 1.5s
    const autoTimer = setTimeout(finishSplash, 1500);

    // Click to skip
    splash.addEventListener('click', finishSplash);

    // Scroll reveal (dynamic): reduces clip and blur progressively
    function onScrollReveal(){
      if (!splash || splash.dataset.closed==='1') return;
      const max = 250; // px to fully reveal
      const p = Math.min(1, window.scrollY / max);
      const start = 150; // starting circle %
      const r = start * (1 - p);
      splash.style.clipPath = `circle(${r}% at 50% 50%)`;
      splash.style.opacity = String(1 - p*0.9);
      app.style.filter = `blur(${(1-p)*8}px)`;
      if (p >= 1) finishSplash();
    }
    window.addEventListener('scroll', onScrollReveal, { passive:true });
    window.addEventListener('touchmove', onScrollReveal, { passive:true });

    // Safety: if fonts/images delay, ensure we still clear
    window.addEventListener('load', () => { if (!splash?.dataset.closed) setTimeout(finishSplash, 300); });
  </script>
</body>
</html>
